<script>
  function validarPassword(pass) {
    return /^(?=.*[A-Z]).{8,}$/.test(pass);
  }

  function iniciarSesion() {
    const loginInput = document.getElementById("login").value.trim().toLowerCase();
    const passwordInput = document.getElementById("password").value;
    const mensaje = document.getElementById("mensaje");

    if (!loginInput || !passwordInput) {
      mensaje.textContent = "Completa los campos";
      mensaje.style.color = "orange";
      return;
    }

    if (!validarPassword(passwordInput)) {
      mensaje.textContent = "Contraseña inválida";
      mensaje.style.color = "orange";
      return;
    }

    let cuentas = JSON.parse(localStorage.getItem("cuentas902")) || [];

    const cuenta = cuentas.find(c => {
      const correo = c.correo.trim().toLowerCase();
      const usuario = c.usuario.trim().toLowerCase();

      return (
        (correo === loginInput || usuario === loginInput) &&
        c.password === passwordInput
      );
    });

    if (!cuenta) {
      mensaje.textContent = "Esta cuenta no existe.";
      mensaje.style.color = "red";
      return;
    }

    localStorage.setItem("sesion902", JSON.stringify(cuenta));

    mensaje.textContent = "Inicio de sesión correcto ✅";
    mensaje.style.color = "lightgreen";

    setTimeout(() => {
      window.location.href = "index.html";
    }, 800);
  }
</script>
